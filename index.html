<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Zambrano Cool Run</title>
  <style>
    body { margin: 0; background:#111; display:flex; justify-content:center; align-items:center; height:100vh; font-family: Arial, sans-serif; }
    canvas { background: linear-gradient(#ffd400, #ffb700); border:4px solid #000; }
    #overlay {
      position:absolute; text-align:center; color:#000; font-weight:bold;
      background:rgba(255,255,255,0.85); padding:20px; border-radius:12px;
    }
    button { padding:10px 18px; font-size:16px; cursor:pointer; }
  </style>
</head>
<body>
  <canvas id="game" width="360" height="600"></canvas>
  <div id="overlay">
    üöóüî•<br/>
    <h2>Zambrano Cool Run</h2>
    <p>Toca la pantalla para moverte<br/>Recoge refrigerante ‚ùÑÔ∏è</p>
    <button onclick="startGame()">Jugar</button>
  </div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const overlay = document.getElementById('overlay');

let car, coolant, score, running;

function resetGame(){
  car = { x: 180, y: 500, w: 40, h: 60 };
  coolant = { x: Math.random()*320+20, y: -40, r: 15 };
  score = 0;
  running = true;
}

function startGame(){
  overlay.style.display='none';
  resetGame();
  requestAnimationFrame(loop);
}

// Input (mobile + desktop): arrastra o toca para mover
canvas.style.touchAction = 'none';

function setCarX(clientX){
  const rect = canvas.getBoundingClientRect();
  const x = clientX - rect.left;
  car.x = x - car.w/2;
  // clamp
  if(car.x < 0) car.x = 0;
  if(car.x + car.w > canvas.width) car.x = canvas.width - car.w;
}

canvas.addEventListener('pointerdown', (e) => {
  e.preventDefault();
  setCarX(e.clientX);
});
canvas.addEventListener('pointermove', (e) => {
  if(e.buttons === 0 && e.pointerType === 'mouse') return; // no drag on desktop unless pressed
  e.preventDefault();
  setCarX(e.clientX);
});

// Fallback for some older mobile browsers
canvas.addEventListener('touchstart', (e) => {
  e.preventDefault();
  setCarX(e.touches[0].clientX);
}, { passive:false });
canvas.addEventListener('touchmove', (e) => {
  e.preventDefault();
  setCarX(e.touches[0].clientX);
}, { passive:false });

function loop(){
  if(!running) return;
  ctx.clearRect(0,0,360,600);

  // draw car
  ctx.fillStyle='#0066cc';
  ctx.fillRect(car.x, car.y, car.w, car.h);

  // draw coolant
  ctx.fillStyle='#00cfff';
  ctx.beginPath();
  ctx.arc(coolant.x, coolant.y, coolant.r, 0, Math.PI*2);
  ctx.fill();

  coolant.y += 4;

  // collision
  if(
    coolant.x > car.x && coolant.x < car.x + car.w &&
    coolant.y > car.y && coolant.y < car.y + car.h
  ){
    score++;
    coolant.y = -40;
    coolant.x = Math.random()*320+20;
  }

  // miss
  if(coolant.y > 640){
    running = false;
    overlay.innerHTML = `üî• FIN DEL JUEGO üî•<br/>Puntos: ${score}<br/><br/>Radiadores Zambrano ¬∑ Zambrano Cool Run<br/><button onclick="startGame()">Reintentar</button>`;
    overlay.style.display='block';
    return;
  }

  ctx.fillStyle='#000';
  ctx.fillText('Refrigerante: '+score, 10, 20);

  requestAnimationFrame(loop);
}
</script>
</body>
</html>
